"use strict";(this.webpackChunkdiscord_app=this.webpackChunkdiscord_app||[]).push([[69661],{269661:(e,t,n)=>{n.r(t);n.d(t,{default:()=>j});var r=n(785893),o=n(667294),a=n(791462),i=n(489992),l=n(992497),s=n(159500),u=n(682964),c=n(25765),d=n(318615),f=n(567895),p=n(356004),h=n(402124),m=n(653772),g=n(171447),v=n(191940),y=n(272729),_=n(67416),b=n(337823),A=n(56133),I=n(418368),C=n(426466),M=n(577573),O=n(813935),T=n(461061),E=n(609993),S=n(959797),R=n(272681),D=n.n(R);function N(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function P(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a=[],i=!0,l=!1;try{for(n=n.call(e);!(i=(r=n.next()).done);i=!0){a.push(r.value);if(t&&a.length===t)break}}catch(e){l=!0;o=e}finally{try{i||null==n.return||n.return()}finally{if(l)throw o}}return a}}(e,t)||Z(e,t)||function(){
throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(e){return function(e){if(Array.isArray(e))return N(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Z(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Z(e,t){if(e){if("string"==typeof e)return N(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);return"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?N(e,t):void 0}}function j(e){var t,n=e.threadId,R=e.attachments,N=e.sendMessage,Z=e.transitionState,j=e.onClose,L=(0,y.Dt)(),w=(0,a.e7)([p.Z],(function(){return p.Z.getChannel(n)}),[n]),F=(0,
a.e7)([m.Z],(function(){return m.Z.getGuild(null==w?void 0:w.getGuildId())}),[w]),U=(0,a.e7)([p.Z],(function(){return p.Z.getChannel(null==w?void 0:w.parent_id)}),[w]),G=null===(t=R[0])||void 0===t?void 0:t.item,k=P(o.useState(null),2),B=k[0],z=k[1];o.useEffect((function(){null!=G&&(0,f.Fq)(G.file,(function(e,t){return z(e)}),E.dG)}),[G]);var X=null!=G&&null!=B?{src:B,width:M.TJ,height:M.Lp,spoiler:R[0].spoiler,alt:R[0].description}:null,q=P(o.useState(!1),2),H=q[0],J=q[1],K=o.useCallback((function(){(0,C.xI)({added:!1});N();j()}),[N,j]),Y=o.useCallback((function(){if(null!=w&&null!=F){(0,C.xI)({added:!0});!function(e){var t,n=e.thread,r=e.attachments,o=e.setIsUploading,a=e.guild,i=e.onClose,f=(null===(t=u.Z.getCurrentConfig({}))||void 0===t?void 0:t.enabled)?new c.Z(T.ANM.MESSAGE(n.id,n.id),"PATCH"):new d.t(T.ANM.MESSAGE(n.id,n.id),"PATCH");f.on("start",(function(){o(!0)}));f.on("progress",(function(e){var t=(0,b.dg)(a.id);if(e.size>t){f.cancel();o(!1);i();(0,A.G)(n,(0,I.KZ)(r))}}))
;f.on("error",(function(e,t){o(!1);if(t===T.evJ.EXPLICIT_CONTENT){i();l.Z.show({title:S.Z.Messages.UPLOAD_AREA_UPLOAD_FAILED_TITLE,body:S.Z.Messages.BOT_GUILD_EXPLICIT_CONTENT.format({name:a.toString()})})}}));f.on("complete",(function(){o(!1);i();s.Z.clearAll(n.id,h.d.ChannelMessage)}));var p=g.Z.getMessages(n.id).get(n.id),m=null!=p?p.attachments:[];f.uploadFiles(r,{attachments:x(m)},"attachments")}({thread:w,attachments:R,setIsUploading:J,guild:F,onClose:j})}}),[w,R,J,F,j]);return null==U?null:(0,r.jsxs)(_.Y0,{transitionState:Z,size:_.Cg.SMALL,className:D().modalRoot,"aria-labelledby":L,children:[(0,r.jsxs)(_.hz,{className:D().modal,children:[(0,r.jsx)(i.X6,{variant:"heading-md/semibold",className:D().header,id:L,children:S.Z.Messages.FORUM_ADD_MEDIA_TO_ORIGINAL_POST_TITLE}),(0,r.jsx)(i.xv,{variant:"text-md/normal",className:D().body,children:S.Z.Messages.FORUM_ADD_MEDIA_TO_ORIGINAL_POST_DESCRIPTION}),(0,r.jsx)("div",{className:D().forumPost,children:(0,r.jsx)(O.oL,{
createStore:function(){return(0,O.NU)(U)},children:(0,r.jsx)(M.ZP,{threadId:n,gotoThread:E.dG,overrideMedia:X})})})]}),(0,r.jsxs)(_.mz,{className:D().modalFooter,children:[(0,r.jsx)(v.Co,{look:v.Co.Looks.BLANK,className:D().cancelButton,disabled:H,onClick:j,children:S.Z.Messages.CANCEL}),(0,r.jsx)(v.Co,{color:v.Co.Colors.PRIMARY,className:D().dontAddButton,disabled:H,onClick:K,children:S.Z.Messages.FORUM_ADD_MEDIA_TO_ORIGINAL_POST_DONT_ADD}),(0,r.jsx)(v.Co,{color:v.Co.Colors.BRAND,className:D().button,submitting:H,onClick:Y,autoFocus:!0,children:S.Z.Messages.FORUM_ADD_MEDIA_TO_ORIGINAL_POST_ADD})]})]})}},910866:(e,t,n)=>{n.d(t,{m:()=>r});var r;!function(e){e.MP4="video/mp4"}(r||(r={}))},567895:(e,t,n)=>{n.d(t,{Zj:()=>m,Fq:()=>g,ZP:()=>y});var r=n(785893),o=n(667294),a=n(678081),i=n(212271),l=n(910866),s=n(959797);function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e){c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){
return e.__proto__||Object.getPrototypeOf(e)};return c(e)}function d(e,t){return!t||"object"!==p(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e,t){f=Object.setPrototypeOf||function(e,t){e.__proto__=t;return e};return f(e,t)}var p=function(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})));return!0}catch(e){return!1}}();return function(){var n,r=c(e);if(t){var o=c(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return d(this,n)}}function m(){return[{name:s.Z.Messages.IMAGES,extensions:["jpg","jpeg","png","gif"]}]}function g(e,t,n){!function(e,t){if(null!=e){
var n=new FileReader;n.onload=function(n){var r;"string"==typeof(null===(r=n.target)||void 0===r?void 0:r.result)&&t(n.target.result,e)};n.readAsDataURL(e)}}(e,(function(r){if(e.type===l.m.MP4)return t(r,e);var o=new Image;o.src=r;o.onload=function(){t(r,e)};o.onerror=function(){n()}}))}var v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}});t&&f(e,t)}(n,e);var t=h(n);function n(){u(this,n);var e;(e=t.apply(this,arguments))._ref=o.createRef();e._isMounted=!1;e.handleFileChange=function(t){var n=e.props,r=n.onFileSizeError,o=n.maxFileSizeBytes;t.stopPropagation();t.preventDefault();if(null!=t.currentTarget.files)for(var a=0;a<t.currentTarget.files.length;a++){var i=t.currentTarget.files[a];i.size>o?null==r||r(o,i.size):g(i,e.handleFileRead,e.handleFileError)}};e.handleFileRead=function(t,n){
var r=e.props.onChange;e._isMounted&&r(t,n)};e.handleFileError=function(){(0,i.xT)({title:s.Z.Messages.PREMIUM_ALERT_ERROR_TITLE,help:s.Z.Messages.UNABLE_TO_PROCESS_IMAGE})};return e}var l=n.prototype;l.componentDidMount=function(){this._isMounted=!0};l.activateUploadDialogue=function(){var e;null===(e=this._ref.current)||void 0===e||e.activateUploadDialogue()};l.render=function(){var e=this.props,t=e.multiple,n=e.disabled,o=e.className,i=e.tabIndex,l=e["aria-label"],s=e.filters;return(0,r.jsx)(a.Z,{ref:this._ref,onChange:this.handleFileChange,filters:null!=s?s:m(),multiple:t,disabled:n,className:o,tabIndex:i,"aria-label":l})};return n}(o.PureComponent);v.defaultProps={multiple:!0,tabIndex:-1,maxFileSizeBytes:1/0};const y=v}}]);
//# sourceMappingURL=0601796cc27c154f7767.js.map