"use strict";(this.webpackChunkdiscord_app=this.webpackChunkdiscord_app||[]).push([[88782],{688782:(t,e,n)=>{n.r(e);n.d(e,{default:()=>W});var o=n(785893),r=n(667294),i=n(441143),c=n.n(i),a=n(791462),s=n(489992),l=n(881548),u=n(549425),p=n(705458),d=n(303540),f=n(23816),h=n(691869),y=n(172458),v=n(994858),b=n(640753),I=n(372196),O=n(367124),P=n(429753),g=n(191940),_=n(761434),j=n(757987),E=n(67416),x=n(391595),C=n(461061),T=n(959797),m=n(524771),S=n.n(m);function N(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function w(t,e,n){e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n;return t}function A(t){A=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)};return A(t)}function M(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},o=Object.keys(n)
;"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))));o.forEach((function(e){w(t,e,n[e])}))}return t}function Z(t,e){e=null!=e?e:{};Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):function(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})));n.push.apply(n,o)}return n}(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}));return t}function L(t,e){return!e||"object"!==R(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function k(t,e){k=Object.setPrototypeOf||function(t,e){t.__proto__=e;return t};return k(t,e)}var R=function(t){
return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function D(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})));return!0}catch(t){return!1}}();return function(){var n,o=A(t);if(e){var r=A(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return L(this,n)}}var V=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}});e&&k(t,e)}(n,t);var e=D(n);function n(){N(this,n);var t;(t=e.apply(this,arguments)).state=Z(M({},(0,y.H2)()),{textFocused:!0,contentWarningProps:null});t.trackInvite=function(e){if(null!=e&&e.ok){var n=t.props,o=n.activity,r=n.channel,i=""
;switch(n.activityActionType){case C.mFx.JOIN:i="Invite to Join";break;case C.mFx.LISTEN:i="Invite to Listen";break;case C.mFx.WATCH:i="Invite to Watch"}f.ZP.trackWithMetadata(C.rMx.INVITE_SENT,{location:"Channel Text Area - ".concat(i),invite_type:o.type===C.IIU.LISTENING?C.dAT.SPOTIFY:C.dAT.APPLICATION,application_id:o.application_id,guild_id:r.getGuildId(),channel_id:r.id,message_id:null!=e?e.body.id:null});return Promise.resolve()}};t.handleTextChange=function(e,n,o){t.setState({textValue:n,richValue:o})};t.handleShare=function(){var e=t.props,n=e.channel,o=e.activity,r=e.activityActionType,i=e.cooldown,c=e.onClose,a=t.state,s=a.textValue,l=a.contentWarningProps;if(i>0)return Promise.resolve({shouldClear:!1,shouldRefocus:!0});var p=b.ZP.parse(n,s),d={activity:o,type:r};if(null!=l){t.setState({contentWarningProps:null});u.Z.sendMessage(n.id,p,!0,{activityAction:d}).then((function(e){return t.trackInvite(e)}));c();return Promise.resolve({shouldClear:!0,shouldRefocus:!0})}return(0,
x.v)({openWarningPopout:function(e){return t.setState({contentWarningProps:e})},type:h.I.FORM,content:s,channel:n}).then((function(e){if(!e.valid)return{shouldClear:!1,shouldRefocus:!1};u.Z.sendMessage(n.id,p,!0,{activityAction:d}).then((function(e){return t.trackInvite(e)}));c();return{shouldClear:!1,shouldRefocus:!1}}))};return t}var r=n.prototype;r.componentDidMount=function(){this.fetchApplication()};r.componentDidUpdate=function(t){this.props.activity.application_id!==t.activity.application_id&&this.fetchApplication()};r.fetchApplication=function(){var t=this.props,e=t.activity,n=t.application;null!=e.application_id&&null==n&&l.Z.fetchApplication(e.application_id)};r.renderTitle=function(){switch(this.props.activity.type){case C.IIU.LISTENING:return T.Z.Messages.INVITE_EMBED_LISTENING_INVITE;case C.IIU.PLAYING:case C.IIU.STREAMING:default:return T.Z.Messages.INVITE_EMBED_GAME_INVITE}};r.render=function(){
var t=this,e=this.state,n=e.textValue,r=e.richValue,i=e.textFocused,a=e.contentWarningProps,l=this.props,u=l.activity,f=l.analyticsLocations,y=l.channel,b=l.activityActionType,I=l.cooldown,O=l.application,P=l.transitionState,x=l.onClose,C=I>0,m=C?T.Z.Messages.CHANNEL_SLOWMODE_COOLDOWN.format({seconds:Math.round((I+1e3)/1e3)}):null;return(0,o.jsxs)(E.Y0,{size:E.Cg.SMALL,transitionState:P,"aria-label":this.renderTitle(),children:[(0,o.jsx)(E.xB,{separator:!1,children:(0,o.jsx)(s.X6,{variant:"heading-lg/semibold",children:this.renderTitle()})}),(0,o.jsxs)(E.hz,{children:[(0,o.jsx)("div",{className:S().subHeader,children:T.Z.Messages.MESSAGE_PREVIEW}),(0,o.jsx)(p.Z,{activityActionType:b,activity:u,className:S().preview,application:O,partyId:null!=u.party?u.party.id:null,isPreview:!0,analyticsLocations:f}),(0,o.jsx)("div",{className:S().subHeader,children:T.Z.Messages.ADD_A_COMMENT_OPTIONAL}),(0,o.jsx)(_.ZP,{position:_.ZP.Positions.TOP,onRequestClose:function(){var e
;null==a||null===(e=a.onCancel)||void 0===e||e.call(a);t.setState({contentWarningProps:null})},shouldShow:null!=a,renderPopout:function(t){var e=t.closePopout;c()(null!=a,"ActivityInvite.render - renderPopout: contentWarningProps cannot be null");return(0,o.jsx)(d.Z,M({onClose:e},a))},children:function(){return(0,o.jsx)(v.Z,{className:S().textArea,textValue:n,richValue:r,focused:i,channel:y,onChange:t.handleTextChange,onSubmit:t.handleShare,type:h.I.FORM})}})]}),(0,o.jsxs)(E.mz,{children:[(0,o.jsx)(j.ZP,{text:m,children:function(e){return(0,o.jsx)("div",Z(M({},e),{children:(0,o.jsx)(g.Co,{disabled:C,onClick:t.handleShare,children:T.Z.Messages.INVITE_EMBED_SEND_INVITE})}))}}),(0,o.jsx)(g.Co,{look:g.Co.Looks.LINK,color:g.Co.Colors.PRIMARY,onClick:x,children:T.Z.Messages.CANCEL})]})]})};return n}(r.PureComponent);const W=a.ZP.connectStores([P.Z,O.Z],(function(t){var e=t.channel,n=t.activity;return{cooldown:P.Z.getSlowmodeCooldownGuess(e.id),
application:null!=n.application_id?O.Z.getGame(n.application_id):I.r9}}))(V)}}]);
//# sourceMappingURL=fb7d67d87d4a44d21726.js.map