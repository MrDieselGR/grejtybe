"use strict";(this.webpackChunkdiscord_app=this.webpackChunkdiscord_app||[]).push([[58755],{958755:(e,t,n)=>{n.r(t);n.d(t,{default:()=>oe});var r=n(785893),s=n(667294),o=n(294184),a=n.n(o),i=n(791462),c=n(489992),l=n(579220),u=n(395951),f=n(566223),d=n(730189),p=n(859169),m=n(64833),A=n(716421),h=n(54037),v=n(655695),S=n(811778),E=n(962564),O=n(493925),I=n(859023),_=n(191940),y=n(629590),b=n(82961),C=n(562181),j=n(732031),g=n(52074),D=n(67416),T=n(766936),N=n(801763),R=n(932847),x=n(894827),w=n(590483),P=n(588641),Z=n(249350),M=n(461061),L=n(298716),k=n(366236),U=n(959797),z=n(163096),G=n.n(z);function V(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function H(e,t,n,r,s,o,a){try{var i=e[o](a),c=i.value}catch(e){n(e);return}i.done?t(c):Promise.resolve(c).then(r,s)}function B(e){return function(){var t=this,n=arguments;return new Promise((function(r,s){var o=e.apply(t,n);function a(e){H(o,r,s,a,i,"next",e)}function i(e){
H(o,r,s,a,i,"throw",e)}a(void 0)}))}}function K(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n;return e}function Y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))));r.forEach((function(t){K(e,t,n[t])}))}return e}function F(e,t){t=null!=t?t:{};Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})));n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function W(e,t){return function(e){
if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,s,o=[],a=!0,i=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0){o.push(r.value);if(t&&o.length===t)break}}catch(e){i=!0;s=e}finally{try{a||null==n.return||n.return()}finally{if(i)throw s}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return V(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return V(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var X=function(e,t){var n,r,s,o,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},
"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(s=2&o[0]?r.return:o[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,o[1])).done)return s;(r=0,s)&&(o=[2&o[0],s.value]);switch(o[0]){case 0:case 1:s=o;break;case 4:a.label++;return{value:o[1],done:!1};case 5:a.label++;r=o[1];o=[0];continue;case 7:o=a.ops.pop();a.trys.pop();continue;default:if(!(s=a.trys,s=s.length>0&&s[s.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!s||o[1]>s[0]&&o[1]<s[3])){a.label=o[1];break}if(6===o[0]&&a.label<s[1]){a.label=s[1];s=o;break}if(s&&a.label<s[2]){a.label=s[2];a.ops.push(o);break}s[2]&&a.ops.pop();a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e];r=0}finally{n=s=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}},$=P.default.getEnableHardwareAcceleration()?T.Xo:T.ZP,q=[{size:T.u8.SIZE_40,
showStatus:!1},{size:T.u8.SIZE_32,showStatus:!1},{size:T.u8.SIZE_40,showStatus:!0},{size:T.u8.SIZE_32,showStatus:!0}];function J(e){return Q.apply(this,arguments)}function Q(){return(Q=B((function(e){var t,n,r,s;return X(this,(function(o){switch(o.label){case 0:t=e.asset,n=e.name;return e.isCustom&&null!==t?[4,fetch(t)]:[2,t];case 1:return[4,o.sent().arrayBuffer()];case 2:r=o.sent();s=new File([r],n,{type:"image/png"});return[4,(0,x.fD)(s)];case 3:return[2,o.sent()]}}))}))).apply(this,arguments)}function ee(e){var t=e.item,n=e.selectedDecoration,o=e.itemKey,l=e.onSelect,u=e.coords,p=(0,i.e7)([d.Z],(function(){return d.Z.useReducedMotion})),m=W(s.useState(null==t.asset),2),A=m[0],h=m[1],v=s.useRef(null),S=(0,f.Z)(v),E=p&&!S&&null!=t.staticAsset?t.staticAsset:t.asset;s.useEffect((function(){if(!A&&null!=t.asset){var e=new Image;e.src=t.asset;e.onload=function(){h(!0)}}}),[A,t.asset]);var O=null==E?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(g.Z,{className:G().notAllowedIcon}),(0,
r.jsx)(c.xv,{variant:"text-xs/normal",color:"header-primary",children:U.Z.Messages.AVATAR_DECORATION_PRESET_NONE})]}):(0,r.jsx)("img",{className:G().presetDecorationImg,src:E,alt:t.descriptor()});return(0,r.jsx)(y.Z,{innerRef:v,style:Y({},u),onClick:function(){return l(t)},className:a()(G().decorationGridItem,K({},G().selected,(null==n?void 0:n.name)===t.name)),children:A?O:(0,r.jsx)(b.Z,{className:G().spinner,type:b.Z.Type.SPINNING_CIRCLE})},o)}function te(e){var t=e.selectedDecoration,n=e.onSelect,o=e.presets;return(0,r.jsxs)("section",{children:[(0,r.jsx)(C.vw,{children:U.Z.Messages.AVATAR_DECORATION_MODAL_DECORATION_SECTION}),(0,r.jsx)(N.ZP,{fade:!0,itemGutter:12,paddingVertical:0,className:G().list,columns:3,sections:[o.length+1],getItemKey:function(e,t){var n;return null===(n=o[t])||void 0===n?void 0:n.name},renderItem:function(e,s,a,i){var c=o[s];return(0,r.jsx)(ee,{item:c,coords:a,selectedDecoration:t,itemKey:i,onSelect:n})},getItemHeight:s.useCallback((function(){return 80
}),[]),removeEdgeItemGutters:!0})]})}function ne(e){var t=e.user,n=e.size,s=e.status,o=e.pendingAvatarDecoration,a=k.H8[n].size,i=(0,S.w)({user:t,size:a,showPending:!0,animateOnHover:!0}),c=i.avatarSrc,l=i.eventHandlers;return(0,r.jsx)("div",{className:G().smallDecorationPreview,children:(0,r.jsx)($,{src:c,size:n,onMouseEnter:l.onMouseEnter,onMouseLeave:l.onMouseLeave,status:s,avatarDecoration:o,"aria-hidden":!0})})}function re(e){var t,n=e.user,s=e.selectedDecoration,o=(0,i.e7)([E.Z],(function(){return E.Z.getStatus(n.id)})),a=(0,S.w)({user:n,showPending:!0,size:k.H8[T.u8.SIZE_120].size}).avatarSrc,c=null!==(t=null==s?void 0:s.data)&&void 0!==t?t:null==s?void 0:s.asset;return(0,r.jsxs)("section",{children:[(0,r.jsx)(C.vw,{children:U.Z.Messages.AVATAR_DECORATION_MODAL_HEADER_PREVIEW_SECTION}),(0,r.jsxs)("div",{className:G().previewSections,children:[(0,r.jsx)("div",{className:G().decorationPreview,children:(0,r.jsx)($,{avatarDecoration:c,src:a,size:T.u8.SIZE_120,
"aria-label":U.Z.Messages.USER_SETTINGS_AVATAR})}),(0,r.jsx)("div",{className:G().smallDecorationPreviewsContainer,children:q.map((function(e,t){var s=e.size,a=e.showStatus;return(0,r.jsx)(ne,{user:n,size:s,pendingAvatarDecoration:c,status:a?o:void 0},t)}))})]})]})}function se(e){var t=e.onApply,n=e.onClose,s=e.user,o=e.disableApplyButton,a=w.ZP.canUsePremiumProfileCustomization(s),c=(0,i.e7)([O.Z],(function(){return O.Z.showNotice()}));if(a)return(0,r.jsxs)(D.mz,{children:[(0,r.jsx)(_.Co,{onClick:t,disabled:o,children:U.Z.Messages.AVATAR_DECORATION_MODAL_APPLY}),(0,r.jsx)(_.Co,{look:_.Co.Looks.LINK,color:_.Co.Colors.PRIMARY,onClick:n,children:U.Z.Messages.PREMIUM_GUILD_SUBSCRIBE_UNUSED_SLOTS_CANCEL})]});var u=w.ZP.isPremium(s)?U.Z.Messages.USER_SETTINGS_CUSTOMIZATION_UPGRADE_UPSELL:U.Z.Messages.USER_SETTINGS_CUSTOMIZATION_UPSELL;return(0,r.jsxs)(D.mz,{className:G().subscribeFooter,children:[(0,r.jsxs)("div",{className:G().buttonsRight,children:[(0,r.jsx)(_.Co,{look:_.Co.Looks.LINK,
color:_.Co.Colors.PRIMARY,onClick:n,children:U.Z.Messages.PREMIUM_GUILD_SUBSCRIBE_UNUSED_SLOTS_CANCEL}),(0,r.jsx)(A.Z,{buttonText:u,subscriptionTier:L.Si.TIER_2})]}),!c&&(0,r.jsx)(_.Co,{onClick:function(e){e.preventDefault();(0,v.uL)(M.Z5c.APPLICATION_STORE);(0,l.xf)();n()},look:_.Co.Looks.LINK,color:_.Co.Colors.LINK,children:U.Z.Messages.AVATAR_DECORATION_MODAL_DISCOVER_MORE_PERKS})]})}function oe(e){var t=e.transitionState,n=e.onClose,o=e.analyticsLocations,a=(0,m.Z)(o,p.Z.EDIT_AVATAR_DECORATION_MODAL).AnalyticsLocationProvider,c=(0,i.e7)([I.default],(function(){return I.default.getCurrentUser()})),l=w.ZP.canUsePremiumProfileCustomization(c),f=l?U.Z.Messages.USER_SETTINGS_HOLIDAY_AVATAR_DECORATIONS_EDIT_MODAL_DESCRIPTION:U.Z.Messages.USER_SETTINGS_HOLIDAY_AVATAR_DECORATION_LIMITED_TIME_DESCRIPTION,d=l?Z.sG:Z.Hm,A=W(s.useState(d[0]),2),v=A[0],S=A[1],E=v.name,O=v.asset,_=v.isCustom,y=v.data,b=_&&void 0===y;s.useEffect((function(){var e,t=(e=B((function(){var e
;return X(this,(function(t){switch(t.label){case 0:return[4,J({name:E,asset:O,isCustom:_})];case 1:if(null===(e=t.sent())||e===O)return[2];S((function(t){return F(Y({},t),{data:e})}));return[2]}}))})),function(){return e.apply(this,arguments)});t()}),[O,E,_]);s.useEffect((function(){R.default.track(M.rMx.OPEN_MODAL,{type:"Edit Avatar Decoration Modal"})}),[]);return null==c?null:(0,r.jsx)(a,{children:(0,r.jsxs)(D.Y0,{transitionState:t,size:D.Cg.DYNAMIC,children:[(0,r.jsxs)(D.xB,{separator:!1,children:[(0,r.jsxs)(C.vw,{tag:C.RB.H1,className:G().modalTitle,children:[(0,r.jsx)(j.Z,{className:G().premiumIcon}),U.Z.Messages.AVATAR_DECORATION_MODAL_HEADER,(0,r.jsx)(h.Z,{className:G().limitedTimeBadge})]}),(0,r.jsx)(D.ol,{onClick:n})]}),(0,r.jsx)(C.R9,{className:G().modalDescription,children:f}),(0,r.jsxs)(D.hz,{className:G().modalContent,children:[(0,r.jsx)(te,{selectedDecoration:v,onSelect:S,presets:d}),(0,r.jsx)(re,{selectedDecoration:v,user:c})]}),(0,r.jsx)(se,{onApply:function(){if(!b){
(0,u.cV)(null===v.asset?null:v);n()}},onClose:n,user:c,disableApplyButton:b})]})})}}}]);
//# sourceMappingURL=1275be60b2fc3383bd16.js.map