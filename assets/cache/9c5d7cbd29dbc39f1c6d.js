"use strict";(this.webpackChunkdiscord_app=this.webpackChunkdiscord_app||[]).push([[64873],{964873:(e,n,t)=>{t.r(n);t.d(n,{default:()=>H});var r=t(785893),l=t(667294),o=t(294184),a=t.n(o),i=t(791462),s=t(489992),c=t(173436),u=t(160156),d=t(53211),h=t(394803),f=t(356004),p=t(1812),g=t(653772),m=t(940712),b=t(105405),O=t(379822),v=t(859023),y=t(191940),x=t(969225),_=t(272729),L=t(983319),C=t(555784),M=t(67416),j=t(897576),w=t(521495),Z=t(932847),I=t(461061),N=t(959797),F=t(705143),S=t.n(F);function E(e,n,t,r,l,o,a){try{var i=e[o](a),s=i.value}catch(e){t(e);return}i.done?n(s):Promise.resolve(s).then(r,l)}function A(e){return function(){var n=this,t=arguments;return new Promise((function(r,l){var o=e.apply(n,t);function a(e){E(o,r,l,a,i,"next",e)}function i(e){E(o,r,l,a,i,"throw",e)}a(void 0)}))}}function D(e,n,t){n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t;return e}function P(e){P=Object.setPrototypeOf?Object.getPrototypeOf:function(e){
return e.__proto__||Object.getPrototypeOf(e)};return P(e)}function T(e,n){return!n||"object"!==R(n)&&"function"!=typeof n?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):n}function k(e,n){k=Object.setPrototypeOf||function(e,n){e.__proto__=n;return e};return k(e,n)}var R=function(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};function G(e){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})));return!0}catch(e){return!1}}();return function(){var t,r=P(e);if(n){var l=P(this).constructor;t=Reflect.construct(r,arguments,l)}else t=r.apply(this,arguments);return T(this,t)}}var B=function(e,n){var t,r,l,o,a={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return o={next:i(0),
throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;a;)try{if(t=1,r&&(l=2&o[0]?r.return:o[0]?r.throw||((l=r.return)&&l.call(r),0):r.next)&&!(l=l.call(r,o[1])).done)return l;(r=0,l)&&(o=[2&o[0],l.value]);switch(o[0]){case 0:case 1:l=o;break;case 4:a.label++;return{value:o[1],done:!1};case 5:a.label++;r=o[1];o=[0];continue;case 7:o=a.ops.pop();a.trys.pop();continue;default:if(!(l=a.trys,l=l.length>0&&l[l.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!l||o[1]>l[0]&&o[1]<l[3])){a.label=o[1];break}if(6===o[0]&&a.label<l[1]){a.label=l[1];l=o;break}if(l&&a.label<l[2]){a.label=l[2];a.ops.push(o);break}l[2]&&a.ops.pop();a.trys.pop();continue}o=n.call(e,a)}catch(e){o=[6,e];r=0}finally{t=l=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}};var W=function(e){!function(e,n){
if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}});n&&k(e,n)}(o,e);var n=G(o);function o(e){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,o);var l;(l=n.call(this,e)).handleGuildSelect=function(e){var n=l.props.guilds,t=l.state.selectedGuildId,r=n[e].channels,o=l.getDefaultChannelId(r);t!==e&&l.setState({selectedGuildId:e,selectedChannelId:o,channels:r})};l.handleChannelSelect=function(e){l.setState({selectedChannelId:e})};l.handleFollow=function(){var e=l.props,n=e.channel,o=e.onClose,a=l.state,i=a.selectedChannelId,s=a.selectedGuildId;if(null!=i){l.setState({submitting:!0});u.Z.createChannelFollower(i,n.id).then((function(){c.Z.dispatch({type:"CHANNEL_FOLLOWER_CREATED",channelId:i,guildId:s});o();(0,j.ZD)(A((function(){var e,n;return B(this,(function(l){switch(l.label){case 0:
return[4,Promise.all([t.e(40532),t.e(63617)]).then(t.bind(t,263617))];case 1:e=l.sent(),n=e.default;return[2,function(e){return(0,r.jsx)(n,function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))));r.forEach((function(n){D(e,n,t[n])}))}return e}({},e))}]}}))})))})).catch((function(e){e.body.code===I.evJ.TOO_MANY_WEBHOOKS?l.setState({errorMessage:N.Z.Messages.FOLLOW_MODAL_TOO_MANY_WEBHOOKS,submitting:!1}):l.setState({errorMessage:N.Z.Messages.FOLLOW_MODAL_FAIL,submitting:!1})}))}};var a=e.guilds,i=e.lastChannelFollowingDestination,s=i.guildId,d=i.channelId;l.state={selectedGuildId:s,selectedChannelId:d,channels:null!=s&&null!=a[s]?a[s].channels:[],errorMessage:null,submitting:!1,headerId:(0,_.hQ)("modal")};return l}var i=o.prototype;i.componentDidMount=function(){
Z.default.track(I.rMx.OPEN_MODAL,{type:"Follow Channel Modal",num_guild_permissions:Object.keys(this.props.guilds).length,location:"Chat Input Blocker - Follow Channel"})};i.getDefaultChannelId=function(e){var n=e.find((function(e){var n=e.channel;return"general"===(0,d.F)(n,v.default,b.Z)})),t=null!=n?n:e[0];return null!=t?t.channel.id:null};i.renderFooter=function(){var e=this.state,n=e.selectedGuildId,t=e.selectedChannelId,o=e.submitting,a=this.props.onClose;return(0,r.jsxs)(l.Fragment,{children:[(0,r.jsx)(y.Co,{submitting:o,onClick:this.handleFollow,disabled:null==n||null==t,children:N.Z.Messages.FOLLOW}),(0,r.jsx)(y.Co,{look:y.Co.Looks.LINK,color:y.Co.Colors.PRIMARY,onClick:a,children:N.Z.Messages.CANCEL})]})};i.renderForm=function(){var e=this.props.guilds,n=this.state,t=n.channels,o=n.selectedGuildId,a=n.selectedChannelId,i=n.errorMessage,c=Object.keys(e).map((function(n){var t=e[n].guild;return{value:n,label:t.toString(),guild:t}})),u=t.map((function(e){
var n=e.channel,t=e.category;return{value:n.id,label:(0,d.F)(n,v.default,b.Z),channel:n,category:t}})),f=0===c.length,p=f?N.Z.Messages.FOLLOW_MODAL_HINT_NO_PERMS:N.Z.Messages.FOLLOW_MODAL_HINT;return(0,r.jsxs)(l.Fragment,{children:[(0,r.jsx)(L.Z,{className:S().bottomMargin,title:N.Z.Messages.FORM_LABEL_SEND_TO,children:(0,r.jsx)(w.Z,{value:o,options:c,isDisabled:f,onChange:this.handleGuildSelect,renderOptionPrefix:function(e){return function(e){if(null==e)return null;var n=e.guild;return(0,r.jsx)(x.Z,{guild:n,size:x.Z.Sizes.MINI})}(e)}})}),(0,r.jsx)(L.Z,{className:S().bottomMargin,title:N.Z.Messages.FORM_LABEL_SELECT_CHANNEL,children:(0,r.jsx)(w.Z,{value:a,options:u,isDisabled:0===u.length,onChange:this.handleChannelSelect,renderOptionPrefix:function(e){return function(e){if(null==e)return null;var n=e.channel,t=(0,h.KS)(n);return null!=t&&(0,r.jsx)(t,{width:16,height:16,className:S().icon})}(e)}})}),(0,r.jsx)(s.xv,{variant:"text-sm/normal",color:f||null!=i?"text-danger":"text-muted",
className:S().bottomMargin,children:null!=i?i:p})]})};i.renderBody=function(){var e=this.props.channel.nsfw;return(0,r.jsxs)("div",{className:S().body,children:[(0,r.jsx)(s.X6,{variant:"heading-lg/semibold",id:this.state.headerId,children:N.Z.Messages.FOLLOW_MODAL_TITLE}),(0,r.jsx)(s.xv,{color:"text-muted",className:a()(S().topMargin,D({},S().formMargin,!e)),variant:"text-sm/normal",children:N.Z.Messages.FOLLOW_MODAL_BODY}),e?(0,r.jsx)(s.xv,{className:a()(S().formMargin,S().topMargin),color:"text-danger",variant:"text-sm/normal",children:N.Z.Messages.FOLLOW_MODAL_WARNING}):null]})};i.renderHeader=function(){var e,n=this.props,t=n.guildToFollow,l=n.channelNameToFollow,o=n.channel,a=null!==(e=(0,h.KS)(o))&&void 0!==e?e:C.Z;return(0,r.jsxs)(M.xB,{className:S().header,children:[(0,r.jsx)(x.Z,{guild:t,size:x.Z.Sizes.LARGE}),(0,r.jsx)("div",{className:S().channelContainer,children:(0,r.jsxs)("div",{className:S().channel,children:[(0,r.jsx)(a,{width:20,height:20,className:S().channelIcon
}),(0,r.jsx)(s.xv,{variant:"text-md/medium",className:S().channelName,children:l})]})})]})};i.render=function(){var e=this.props.transitionState;return(0,r.jsxs)(M.Y0,{transitionState:e,"aria-labelledby":this.state.headerId,children:[this.renderHeader(),(0,r.jsxs)(M.hz,{className:S().content,children:[this.renderBody(),this.renderForm()]}),(0,r.jsx)(M.mz,{children:this.renderFooter()})]})};return o}(l.PureComponent);const H=i.ZP.connectStores([g.Z,f.Z,p.ZP,m.Z,O.Z],(function(e){var n=e.channel,t=g.Z.getGuild(n.guild_id),r=Object.values(g.Z.getGuilds()).reduce((function(e,n){var t=p.ZP.getChannels(n.id).SELECTABLE.map((function(e){return e.channel})).filter((function(e){return e.type===I.d4z.GUILD_TEXT&&m.Z.can(I.Plq.MANAGE_WEBHOOKS,e)})).map((function(e){var n=f.Z.getChannel(e.parent_id);return{channel:e,category:null!=n?n.name:null}}));t.length>0&&(e[n.id]={guild:n,channels:t});return e}),{}),l=O.Z.getLastChannelFollowingDestination();return{guildToFollow:t,channelNameToFollow:n.name,
guilds:r,lastChannelFollowingDestination:null!=l?l:{}}}),{forwardRef:!0})(W)}}]);
//# sourceMappingURL=9c5d7cbd29dbc39f1c6d.js.map